<view class="alert alert-danger" wx:if="{{error}}">{{error}}</view>

<view class="listen" wx:if="{{type === 0 || type === 2}}">
  <view class="header cover">
    <view class="h1">{{title}}</view>
    <view class="player">
      <view class="progress-bar">
        <text class="current">{{audioCurrent}}</text>
        <slider bind:change="seekAudio" value="{{audioPosition}}" max="{{audioDuration}}" activeColor="#ce8101"></slider>
        <text class="total">{{sliderMax}}</text>
      </view>
      <view class="controls">
        <button class="backward-button" type="button" bind:tap="backward">
          <view></view>
        </button>
        <button class="pause-button" type="button" bind:tap="pause" wx:if="{{isPlaying}}">暂停</button>
        <button class="play-button" type="button" bind:tap="play" wx:else>
          <view></view>
        </button>
        <button class="forward-button" type="button" bind:tap="forward">
          <view></view>
        </button>
      </view>
    </view>
  </view>

  <view class="listen-select cover" wx:if="{{type === 0}}">
    <view class="switch" wx:if="{{showExplanation}}">
      <text>解析</text>
      <switch color="#f29801" bind:change="changeExplanation"></switch>
      <text>原文</text>
    </view>
    <text class="original-article" wx:if="{{showExplanation && showArticle}}">{{article}}</text>
    <form bind:submit="submitSelect" wx:else="">
      <radio-group class="group {{showExplanation ? question.correct ? 'correct' : 'wrong' : ''}}"
                   bind:change="setAnswer"
                   wx:for="{{extra.questions}}"
                   wx:for-item="question"
                   wx:for-index="qIndex"
                   data-index="{{qIndex}}">
        <text class="index">{{qIndex + 1}}.</text>
        <label wx:for="{{question.options}}">
          <icon type="success" size="16" wx:if="{{question.select === index}}" color="#f29801"></icon>
          <view class="icon" wx:else></view>
          <radio hidden value="{{index}}" checked="{{question.select === index}}"></radio>
          <text>{{item.title}}</text>
        </label>
      </radio-group>
      <button type="primary" form-type="submit" wx:if="{{!showExplanation}}">提交</button>
    </form>
    <view class="explanation" wx:if="{{showExplanation}}">
      <text class="h2">答案解析：</text>
      <text>{{explanation}}</text>
    </view>
  </view>

  <view class="listen-fill cover" wx:else>
    <text class="original-article">{{article}}</text>
    <view class="h2">答题</view>
    <form bind:submit="submitFill">
      <view class="blank-list">
        <view class="blank-item {{showExplanation ? item.correct ? 'correct' : 'wrong' : ''}}" wx:for="{{blanks}}">
          <text>{{index + 1}}.</text>
          <input type="text" name="{{'blank-' + index}}" confirm-type="next" bind:confirm="setInput" data-index="{{index}}" />
        </view>
      </view>
      <button type="primary" form-type="submit" wx:if="{{!showExplanation}}">提交</button>
    </form>
  </view>

  <button type="primary" wx:if="{{showExplanation && hasNext}}" bind:tap="doNextExercise">下一题</button>
</view>